
<p class="level0">
<p class="level0">
<p class="level0">
<p class="level0"><a name="NAME"></a><h2 class="nroffsh">NAME</h2>
<p class="level0">patch - apply a diff file to an original <a name="SYNOPSIS"></a><h2 class="nroffsh">SYNOPSIS</h2>
<p class="level0"><span Class="bold">patch</span> 
<p class="level0">
<p class="level0">
<p class="level0">
<p class="level0">but usually just 
<p class="level0"><span Class="bold">patch -p num</span> <span Class="bold">&lt; patchfile</span> <a name="DESCRIPTION"></a><h2 class="nroffsh">DESCRIPTION</h2>
<p class="level0"><span Class="bold">patch</span> takes a patch file <span Class="emphasis">patchfile</span> containing a difference listing produced by the <span Class="bold">diff</span> program and applies those differences to one or more original files, producing patched versions. Normally the patched versions are put in place of the originals. Backups can be made; see the <span Class="bold">-b</span> or <span Class="bold">\*=backup</span> option. The names of the files to be patched are usually taken from the patch file, but if there's just one file to be patched it can be specified on the command line as <span Class="emphasis">originalfile .</span> 
<p class="level0">Upon startup, patch attempts to determine the type of the diff listing, unless overruled by a <span Class="bold">-c</span> (<span Class="bold">*=context</span>), <span Class="bold">-e</span> (<span Class="bold">*=ed</span>), <span Class="bold">-n</span> (<span Class="bold">*=normal</span>), or <span Class="bold">-u</span> (<span Class="bold">*=unified</span>) option. Context diffs (old-style, new-style, and unified) and normal diffs are applied by the <span Class="bold">patch</span> program itself, while <span Class="bold">ed</span> diffs are simply fed to the <span Class="manpage">ed (1)</span>editor via a pipe. 
<p class="level0"><span Class="bold">patch</span> tries to skip any leading garbage, apply the diff, and then skip any trailing garbage. Thus you could feed an article or message containing a diff listing to <span Class="manpage">patch</span>and it should work. If the entire diff is indented by a consistent amount, if lines end in s-1CRLFs0, or if a diff is encapsulated one or more times by prepending "<span Class="bold">- </span>" to lines starting with "<span Class="bold">-</span>" as specified by Internet <a href="http://www.ietf.org/rfc/rfc934.txt">RFC 934</a>, this is taken into account. After removing indenting or encapsulation, lines beginning with <a class="bold" href="#">#</a> are ignored, as they are considered to be comments. 
<p class="level0">With context diffs, and to a lesser extent with normal diffs, <span Class="bold">patch</span> can detect when the line numbers mentioned in the patch are incorrect, and attempts to find the correct place to apply each hunk of the patch. As a first guess, it takes the line number mentioned for the hunk, plus or minus any offset used in applying the previous hunk. If that is not the correct place, <span Class="bold">patch</span> scans both forwards and backwards for a set of lines matching the context given in the hunk. First <span Class="bold">patch</span> looks for a place where all lines of the context match. If no such place is found, and it's a context diff, and the maximum fuzz factor is set to 1 or more, then another scan takes place ignoring the first and last line of context. If that fails, and the maximum fuzz factor is set to 2 or more, the first two and last two lines of context are ignored, and another scan is made. (The default maximum fuzz factor is 2.) 
<p class="level0">Hunks with less prefix context than suffix context (after applying fuzz) must apply at the start of the file if their first line number is&nbsp;1.  Hunks with more prefix context than suffix context (after applying fuzz) must apply at the end of the file. 
<p class="level0">If <span Class="bold">patch</span> cannot find a place to install that hunk of the patch, it puts the hunk out to a reject file, which normally is the name of the output file plus a <span Class="bold">\&.rej</span> suffix, or <a class="bold" href="#">#</a> if <span Class="bold">\&.rej</span> would generate a file name that is too long (if even appending the single character <a class="bold" href="#">#</a> makes the file name too long, then <a class="bold" href="#">#</a> replaces the file name's last character). 
<p class="level0">The rejected hunk comes out in unified or context diff format. If the input was a normal diff, many of the contexts are simply null. The line numbers on the hunks in the reject file may be different than in the patch file: they reflect the approximate location patch thinks the failed hunks belong in the new file rather than the old one. 
<p class="level0">As each hunk is completed, you are told if the hunk failed, and if so which line (in the new file) <span Class="bold">patch</span> thought the hunk should go on. If the hunk is installed at a different line from the line number specified in the diff, you are told the offset. A single large offset <span Class="emphasis">may</span> indicate that a hunk was installed in the wrong place. You are also told if a fuzz factor was used to make the match, in which case you should also be slightly suspicious. If the <span Class="bold">\*=verbose</span> option is given, you are also told about hunks that match exactly. 
<p class="level0">If no original file <span Class="emphasis">origfile</span> is specified on the command line, <span Class="bold">patch</span> tries to figure out from the leading garbage what the name of the file to edit is, using the following rules. 
<p class="level0">First, <span Class="bold">patch</span> takes an ordered list of candidate file names as follows: 
<p class="level0"><span Class="bold"> \(bu</span> If the header is that of a context diff, <span Class="bold">patch</span> takes the old and new file names in the header. A name is ignored if it does not have enough slashes to satisfy the <span Class="bold">-p num</span> or <span Class="bold">\*=strip= num</span> option. The name <span Class="bold">/dev/null</span> is also ignored. 
<p class="level0"><span Class="bold"> \(bu</span> If there is an <span Class="bold">Index:\&</span> line in the leading garbage and if either the old and new names are both absent or if <span Class="bold">patch</span> is conforming to s-1POSIXs0, <span Class="bold">patch</span> takes the name in the <span Class="bold">Index:\&</span> line. 
<p class="level0"><span Class="bold"> \(bu</span> For the purpose of the following rules, the candidate file names are considered to be in the order (old, new, index), regardless of the order that they appear in the header. 
<p class="level0">Then <span Class="bold">patch</span> selects a file name from the candidate list as follows: 
<p class="level0"><span Class="bold"> \(bu</span> If some of the named files exist, <span Class="bold">patch</span> selects the first name if conforming to s-1POSIXs0, and the best name otherwise. 
<p class="level0"><span Class="bold"> \(bu</span> If <span Class="bold">patch</span> is not ignoring s-1RCSs0, ClearCase, Perforce, and s-1SCCSs0 (see the <span Class="bold">-g\  num</span> or <span Class="bold">\*=get= num</span> option), and no named files exist but an s-1RCSs0, ClearCase, Perforce, or s-1SCCSs0 master is found, <span Class="bold">patch</span> selects the first named file with an s-1RCSs0, ClearCase, Perforce, or s-1SCCSs0 master. 
<p class="level0"><span Class="bold"> \(bu</span> If no named files exist, no s-1RCSs0, ClearCase, Perforce, or s-1SCCSs0 master was found, some names are given, <span Class="bold">patch</span> is not conforming to s-1POSIXs0, and the patch appears to create a file, <span Class="bold">patch</span> selects the best name requiring the creation of the fewest directories. 
<p class="level0"><span Class="bold"> \(bu</span> If no file name results from the above heuristics, you are asked for the name of the file to patch, and <span Class="bold">patch</span> selects that name. 
<p class="level0">To determine the <span Class="emphasis">best</span> of a nonempty list of file names, <span Class="bold">patch</span> first takes all the names with the fewest path name components; of those, it then takes all the names with the shortest basename; of those, it then takes all the shortest names; finally, it takes the first remaining name. 
<p class="level0">Additionally, if the leading garbage contains a <span Class="bold">Prereq:\&</span> line, <span Class="bold">patch</span> takes the first word from the prerequisites line (normally a version number) and checks the original file to see if that word can be found. If not, <span Class="bold">patch</span> asks for confirmation before proceeding. 
<p class="level0">The upshot of all this is that you should be able to say, while in a news interface, something like the following: 
<p class="level0">
<p class="level1"><a class="bold" href="#">| patch -d /usr/src/local/blurfl</a> 
<p class="level0">
<p class="level0">and patch a file in the <span Class="bold">blurfl</span> directory directly from the article containing the patch. 
<p class="level0">If the patch file contains more than one patch, <span Class="bold">patch</span> tries to apply each of them as if they came from separate patch files. This means, among other things, that it is assumed that the name of the file to patch must be determined for each diff listing, and that the garbage before each diff listing contains interesting things such as file names and revision level, as mentioned previously. <a name="OPTIONS"></a><h2 class="nroffsh">OPTIONS</h2>
<p class="level0">
<p class="level0"><span Class="bold">-b</span>  or  <span Class="bold">*=backup</span> Make backup files. That is, when patching a file, rename or copy the original instead of removing it. See the <span Class="bold">-V</span> or <span Class="bold">\*=version-control</span> option for details about how backup file names are determined. 
<p class="level0"><span Class="bold">\*=backup-if-mismatch</span> Back up a file if the patch does not match the file exactly and if backups are not otherwise requested. This is the default unless <span Class="bold">patch</span> is conforming to s-1POSIXs0. 
<p class="level0"><span Class="bold">\*=no-backup-if-mismatch</span> Do not back up a file if the patch does not match the file exactly and if backups are not otherwise requested. This is the default if <span Class="bold">patch</span> is conforming to s-1POSIXs0. 
<p class="level0"><span Class="bold">-B</span> <span Class="emphasis">pref</span>  or  <span Class="bold">*=prefix=</span><span Class="emphasis">pref</span> Use the <span Class="bold">simple</span> method to determine backup file names (see the <span Class="bold">-V  method</span> or <span Class="bold">\*=version-control  method</span> option), and append <span Class="emphasis">pref</span> to a file name when generating its backup file name. For example, with <span Class="bold">-B\ /junk/</span> the simple backup file name for <span Class="bold">src/patch/util.c</span> is <span Class="manpage">/junk/src/patch/util.c .</span>
<p class="level0"><span Class="bold">*=binary</span> Write all files in binary mode, except for standard output and <span Class="manpage">/dev/tty .</span>When reading, disable the heuristic for transforming CRLF line endings into LF line endings.  This option is needed on s-1POSIXs0 systems when applying patches generated on non-s-1POSIXs0 systems to non-s-1POSIXs0 files. (On s-1POSIXs0 systems, file reads and writes never transform line endings. On Windows, reads and writes do transform line endings by default, and patches should be generated by <span Class="bold">diff\ \*=binary</span> when line endings are significant.) 
<p class="level0"><span Class="bold">-c</span>  or  <span Class="bold">*=context</span> Interpret the patch file as a ordinary context diff. 
<p class="level0"><span Class="bold">-d</span> <span Class="emphasis">dir</span>  or  <span Class="bold">*=directory=</span><span Class="emphasis">dir</span> Change to the directory <span Class="emphasis">dir</span> immediately, before doing anything else. 
<p class="level0"><span Class="bold">-D</span> <span Class="emphasis">define</span>  or  <span Class="bold">*=ifdef=</span><span Class="emphasis">define</span> Use the <span Class="manpage">#ifdef  .\|.\|.  #endif</span>construct to mark changes, with <span Class="emphasis">define</span> as the differentiating symbol. 
<p class="level0"><span Class="bold">\*=dry-run</span> Print the results of applying the patches without actually changing any files. 
<p class="level0"><span Class="bold">-e</span>  or  <span Class="bold">*=ed</span> Interpret the patch file as an <span Class="bold">ed</span> script. 
<p class="level0"><span Class="bold">-E</span>  or  <span Class="bold">*=remove-empty-files</span> Remove output files that are empty after the patches have been applied. Normally this option is unnecessary, since <span Class="bold">patch</span> can examine the time stamps on the header to determine whether a file should exist after patching. However, if the input is not a context diff or if <span Class="bold">patch</span> is conforming to s-1POSIXs0, <span Class="bold">patch</span> does not remove empty patched files unless this option is given. When <span Class="bold">patch</span> removes a file, it also attempts to remove any empty ancestor directories. 
<p class="level0"><span Class="bold">-f</span>  or  <span Class="bold">*=force</span> Assume that the user knows exactly what he or she is doing, and do not ask any questions.  Skip patches whose headers do not say which file is to be patched; patch files even though they have the wrong version for the <span Class="bold">Prereq:\&</span> line in the patch; and assume that patches are not reversed even if they look like they are. This option does not suppress commentary; use <span Class="bold">-s</span> for that. 
<p class="level0"><span Class="bold">-F</span> <span Class="emphasis">num</span>  or  <span Class="bold">*=fuzz=</span><span Class="emphasis">num</span> Set the maximum fuzz factor. This option only applies to diffs that have context, and causes <span Class="bold">patch</span> to ignore up to that many lines of context in looking for places to install a hunk. Note that a larger fuzz factor increases the odds of a faulty patch. The default fuzz factor is 2.  A fuzz factor greater than or equal to the number of lines of context in the context diff, ordinarily 3, ignores all context. 
<p class="level0"><span Class="bold">-g</span> <span Class="emphasis">num</span>  or  <span Class="bold">*=get=</span><span Class="emphasis">num</span> This option controls <span Class="manpage">patch 's</span>actions when a file is under s-1RCSs0 or s-1SCCSs0 control, and does not exist or is read-only and matches the default version, or when a file is under ClearCase or Perforce control and does not exist. If <span Class="emphasis">num</span> is positive, <span Class="bold">patch</span> gets (or checks out) the file from the revision control system; if zero, <span Class="bold">patch</span> ignores s-1RCSs0, ClearCase, Perforce, and s-1SCCSs0 and does not get the file; and if negative, <span Class="bold">patch</span> asks the user whether to get the file. The default value of this option is given by the value of the <span Class="bold">PATCH_GET</span> environment variable if it is set; if not, the default value is zero. 
<p class="level0"><span Class="bold">\*=help</span> Print a summary of options and exit. 
<p class="level0"><span Class="bold">-i</span> <span Class="emphasis">patchfile</span>  or  <span Class="bold">*=input=</span><span Class="emphasis">patchfile</span> Read the patch from <span Class="emphasis">patchfile .</span> If <span Class="emphasis">patchfile</span> is <span Class="manpage">-</span>read from standard input, the default. 
<p class="level0"><span Class="bold">-l</span>  or  <span Class="bold">*=ignore-whitespace</span> Match patterns loosely, in case tabs or spaces have been munged in your files. Any sequence of one or more blanks in the patch file matches any sequence in the original file, and sequences of blanks at the ends of lines are ignored. Normal characters must still match exactly. Each line of the context must still match a line in the original file. 
<p class="level0"><span Class="bold">*=merge</span> or <span Class="bold">*=merge=merge</span> or <span Class="bold">*=merge=diff3</span> Merge a patch file into the original files similar to <span Class="bold">diff3</span>(1) or <span Class="bold">merge</span>(1).  If a conflict is found, <span Class="bold">patch</span> outputs a warning and brackets the conflict with <span Class="bold">&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span> and <span Class="bold">&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span> lines. A typical conflict will look like this: 
<p class="level0">
<p class="level1"><pre class="level1">
<span class="bold">&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span> 
<span class="emphasis">lines from the original file</span> <span class="bold">|||||||</span> 
<span class="emphasis">original lines from the patch</span> <span class="bold">=======</span> 
<span class="emphasis">new lines from the patch</span> <span class="bold">&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span> 
</pre>

<p class="level0">
<p class="level0"><a name=""></a><span class="nroffip"> 3</span> 
<p class="level1">The optional argument of <span Class="bold">*=merge</span> determines the output format for conflicts: the diff3 format shows the <a class="bold" href="#">|||||||</a> section with the original lines from the patch; in the merge format, this section is missing.  The merge format is the default. 
<p class="level1">This option implies <span Class="bold">*=forward</span> and does not take the <span Class="bold">--fuzz</span>=<span Class="emphasis">num</span> option into account. 
<p class="level1"><span Class="bold">-n</span>  or  <span Class="bold">*=normal</span> Interpret the patch file as a normal diff. 
<p class="level1"><span Class="bold">-N</span>  or  <span Class="bold">*=forward</span> When a patch does not apply, patch usually checks if the patch looks like it has been reversed.  The <span Class="bold">*=forward</span> option prevents that. See also <span Class="manpage">-R .</span>
<p class="level1"><span Class="bold">-o</span> <span Class="emphasis">outfile</span>  or  <span Class="bold">*=output=</span><span Class="emphasis">outfile</span> Send output to <span Class="emphasis">outfile</span> instead of patching files in place. Do not use this option if <span Class="emphasis">outfile</span> is one of the files to be patched. When <span Class="emphasis">outfile</span> is <span Class="bold">-</span>, send output to standard output, and send any messages that would usually go to standard output to standard error. 
<p class="level1"><span Class="bold">-p</span><span Class="emphasis">num</span>  or  <span Class="bold">*=strip</span><a class="bold" href="#">=</a><span Class="emphasis">num</span> Strip the smallest prefix containing <span Class="emphasis">num</span> leading slashes from each file name found in the patch file. A sequence of one or more adjacent slashes is counted as a single slash. This controls how file names found in the patch file are treated, in case you keep your files in a different directory than the person who sent out the patch. For example, supposing the file name in the patch file was 
<p class="level1">
<p class="level2"><span Class="bold">/u/howard/src/blurfl/blurfl.c</span> 
<p class="level1">
<p class="level1">setting <span Class="bold">-p0</span> gives the entire file name unmodified, <span Class="bold">-p1</span> gives 
<p class="level1">
<p class="level2"><span Class="bold">u/howard/src/blurfl/blurfl.c</span> 
<p class="level1">
<p class="level1">without the leading slash, <span Class="bold">-p4</span> gives 
<p class="level1">
<p class="level2"><span Class="bold">blurfl/blurfl.c</span> 
<p class="level1">
<p class="level1">and not specifying <span Class="bold">-p</span> at all just gives you <span Class="bold">blurfl.c</span>. Whatever you end up with is looked for either in the current directory, or the directory specified by the <span Class="bold">-d</span> option. 
<p class="level1"><span Class="bold">\*=posix</span> Conform more strictly to the s-1POSIXs0 standard, as follows. 
<p class="level2">
<p class="level2"><span Class="bold"> \(bu</span> Take the first existing file from the list (old, new, index) when intuiting file names from diff headers. 
<p class="level2"><span Class="bold"> \(bu</span> Do not remove files that are empty after patching. 
<p class="level2"><span Class="bold"> \(bu</span> Do not ask whether to get files from s-1RCSs0, ClearCase, Perforce, or s-1SCCSs0. 
<p class="level2"><span Class="bold"> \(bu</span> Require that all options precede the files in the command line. 
<p class="level2"><span Class="bold"> \(bu</span> Do not backup files when there is a mismatch. 
<p class="level1">
<p class="level1"><span Class="bold">\*=quoting-style= word</span> Use style <span Class="emphasis">word</span> to quote output names. The <span Class="emphasis">word</span> should be one of the following: 
<p class="level2">
<p class="level2"><span Class="bold">literal</span> Output names as-is. 
<p class="level2"><span Class="bold">shell</span> Quote names for the shell if they contain shell metacharacters or would cause ambiguous output. 
<p class="level2"><span Class="bold">shell-always</span> Quote names for the shell, even if they would normally not require quoting. 
<p class="level2"><span Class="bold">c</span> Quote names as for a C language string. 
<p class="level2"><span Class="bold">escape</span> Quote as with <span Class="bold">c</span> except omit the surrounding double-quote characters. 
<p class="level2">You can specify the default value of the <span Class="bold">\*=quoting-style</span> option with the environment variable <span Class="manpage">QUOTING_STYLE .</span>If that environment variable is not set, the default value is <span Class="manpage">shell .</span>
<p class="level1">
<p class="level1"><span Class="bold">-r</span> <span Class="emphasis">rejectfile</span>  or  <span Class="bold">*=reject-file=</span><span Class="emphasis">rejectfile</span> Put rejects into <span Class="emphasis">rejectfile</span> instead of the default <span Class="bold">\&.rej</span> file.  When <span Class="emphasis">rejectfile</span> is <span Class="bold">-</span>, discard rejects. 
<p class="level1"><span Class="bold">-R</span>  or  <span Class="bold">*=reverse</span> Assume that this patch was created with the old and new files swapped. (Yes, I'm afraid that does happen occasionally, human nature being what it is.) <span Class="bold">patch</span> attempts to swap each hunk around before applying it. Rejects come out in the swapped format. The <span Class="bold">-R</span> option does not work with <span Class="bold">ed</span> diff scripts because there is too little information to reconstruct the reverse operation. 
<p class="level1">If the first hunk of a patch fails, <span Class="bold">patch</span> reverses the hunk to see if it can be applied that way. If it can, you are asked if you want to have the <span Class="bold">-R</span> option set. If it can't, the patch continues to be applied normally. (Note: this method cannot detect a reversed patch if it is a normal diff and if the first command is an append (i.e. it should have been a delete) since appends always succeed, due to the fact that a null context matches anywhere. Luckily, most patches add or change lines rather than delete them, so most reversed normal diffs begin with a delete, which fails, triggering the heuristic.) 
<p class="level1"><span Class="bold">*=read-only=</span><span Class="emphasis">behavior</span> Behave as requested when trying to modify a read-only file: <span Class="bold">ignore</span> the potential problem, <span Class="bold">warn</span> about it (the default), or <span Class="bold">fail</span>. 
<p class="level1"><span Class="bold">*=reject-format=</span><span Class="emphasis">format</span> Produce reject files in the specified <span Class="emphasis">format</span> (either <span Class="bold">context</span> or <span Class="bold">unified</span>).  Without this option, rejected hunks come out in unified diff format if the input patch was of that format, otherwise in ordinary context diff form. 
<p class="level1"><span Class="bold">-s</span>  or  <span Class="bold">*=silent</span>  or  <span Class="bold">*=quiet</span> Work silently, unless an error occurs. 
<p class="level1"><span Class="bold">*=follow-symlinks</span> When looking for input files, follow symbolic links.  Replaces the symbolic links, instead of modifying the files the symbolic links point to.  Git-style patches to symbolic links will no longer apply.  This option exists for backwards compatibility with previous versions of patch; its use is discouraged. 
<p class="level1"><span Class="bold">-t</span>  or  <span Class="bold">*=batch</span> Suppress questions like <span Class="manpage">-f</span>but make some different assumptions: skip patches whose headers do not contain file names (the same as <span Class="bold">-f</span>); skip patches for which the file has the wrong version for the <span Class="bold">Prereq:\&</span> line in the patch; and assume that patches are reversed if they look like they are. 
<p class="level1"><span Class="bold">-T</span>  or  <span Class="bold">*=set-time</span> Set the modification and access times of patched files from time stamps given in context diff headers.  Unless specified in the time stamps, assume that the context diff headers use local time. 
<p class="level1">Use of this option with time stamps that do not include time zones is not recommended, because patches using local time cannot easily be used by people in other time zones, and because local time stamps are ambiguous when local clocks move backwards during daylight-saving time adjustments.  Make sure that time stamps include time zones, or generate patches with s-1UTCs0 and use the <span Class="bold">-Z</span> or <span Class="bold">\*=set-utc</span> option instead. 
<p class="level1"><span Class="bold">-u</span>  or  <span Class="bold">*=unified</span> Interpret the patch file as a unified context diff. 
<p class="level1"><span Class="bold">-v</span>  or  <span Class="bold">*=version</span> Print out <span Class="manpage">patch 's</span>revision header and patch level, and exit. 
<p class="level1"><span Class="bold">-V</span> <span Class="emphasis">method</span>  or  <span Class="bold">*=version-control=</span><span Class="emphasis">method</span> Use <span Class="emphasis">method</span> to determine backup file names.  The method can also be given by the <span Class="bold">PATCH_VERSION_CONTROL</span> (or, if that's not set, the <span Class="manpage">VERSION_CONTROL )</span>environment variable, which is overridden by this option. The method does not affect whether backup files are made; it affects only the names of any backup files that are made. 
<p class="level1">The value of <span Class="emphasis">method</span> is like the s-1GNUs0 Emacs `version-control' variable; <span Class="bold">patch</span> also recognizes synonyms that are more descriptive.  The valid values for <span Class="emphasis">method</span> are (unique abbreviations are accepted): 
<p class="level2">
<p class="level2"><span Class="bold">existing</span>  or  <span Class="bold">nil</span> Make numbered backups of files that already have them, otherwise simple backups. This is the default. 
<p class="level2"><span Class="bold">numbered</span>  or  <span Class="bold">t</span> Make numbered backups.  The numbered backup file name for <span Class="emphasis">F</span> is 
<p class="level2">where <span Class="emphasis">N</span> is the version number. 
<p class="level2"><span Class="bold">simple</span>  or  <span Class="bold">never</span> Make simple backups. The <span Class="bold">-B</span> or <span Class="manpage">\*=prefix</span><span Class="bold">-Y</span> or <span Class="manpage">\*=basename-prefix</span>and <span Class="bold">-z</span> or <span Class="manpage">\*=suffix</span>options specify the simple backup file name. If none of these options are given, then a simple backup suffix is used; it is the value of the <span Class="bold">SIMPLE_BACKUP_SUFFIX</span> environment variable if set, and is <span Class="bold">\&.orig</span> otherwise. 
<p class="level2">With numbered or simple backups, if the backup file name is too long, the backup suffix <a class="bold" href="#">~</a> is used instead; if even appending <a class="bold" href="#">~</a> would make the name too long, then <a class="bold" href="#">~</a> replaces the last character of the file name. 
<p class="level1">
<p class="level1"><span Class="bold">*=verbose</span> Output extra information about the work being done. 
<p class="level1"><span Class="bold">-x</span> <span Class="emphasis">num</span>  or  <span Class="bold">*=debug=</span><span Class="emphasis">num</span> Set internal debugging flags of interest only to <span Class="bold">patch</span> patchers. 
<p class="level1"><span Class="bold">-Y</span> <span Class="emphasis">pref</span>  or  <span Class="bold">*=basename-prefix=</span><span Class="emphasis">pref</span> Use the <span Class="bold">simple</span> method to determine backup file names (see the <span Class="bold">-V  method</span> or <span Class="bold">\*=version-control  method</span> option), and prefix <span Class="emphasis">pref</span> to the basename of a file name when generating its backup file name. For example, with <span Class="bold">-Y\ .del/</span> the simple backup file name for <span Class="bold">src/patch/util.c</span> is <span Class="manpage">src/patch/.del/util.c .</span>
<p class="level1"><span Class="bold">-z</span> <span Class="emphasis">suffix</span>  or  <span Class="bold">*=suffix=</span><span Class="emphasis">suffix</span> Use the <span Class="bold">simple</span> method to determine backup file names (see the <span Class="bold">-V  method</span> or <span Class="bold">\*=version-control  method</span> option), and use <span Class="emphasis">suffix</span> as the suffix. For example, with <span Class="bold">-z\ -</span> the backup file name for <span Class="bold">src/patch/util.c</span> is <span Class="manpage">src/patch/util.c- .</span>
<p class="level1"><span Class="bold">-Z</span>  or  <span Class="bold">*=set-utc</span> Set the modification and access times of patched files from time stamps given in context diff headers. Unless specified in the time stamps, assume that the context diff headers use Coordinated Universal Time (s-1UTCs0, often known as s-1GMTs0).  Also see the <span Class="bold">-T</span> or <span Class="bold">\*=set-time</span> option. 
<p class="level1">The <span Class="bold">-Z</span> or <span Class="bold">\*=set-utc</span> and <span Class="bold">-T</span> or <span Class="bold">\*=set-time</span> options normally refrain from setting a file's time if the file's original time does not match the time given in the patch header, or if its contents do not match the patch exactly.  However, if the <span Class="bold">-f</span> or <span Class="bold">\*=force</span> option is given, the file time is set regardless. 
<p class="level1">Due to the limitations of <span Class="bold">diff</span> output format, these options cannot update the times of files whose contents have not changed.  Also, if you use these options, you should remove (e.g. with <span Class="manpage">make\ clean )</span>all files that depend on the patched files, so that later invocations of <span Class="bold">make</span> do not get confused by the patched files' times. <a name="ENVIRONMENT"></a><h2 class="nroffsh">ENVIRONMENT</h2>
<p class="level0">
<p class="level0"><span Class="bold">PATCH_GET</span> This specifies whether <span Class="bold">patch</span> gets missing or read-only files from s-1RCSs0, ClearCase, Perforce, or s-1SCCSs0 by default; see the <span Class="bold">-g</span> or <span Class="bold">\*=get</span> option. 
<p class="level0"><span Class="bold">POSIXLY_CORRECT</span> If set, <span Class="bold">patch</span> conforms more strictly to the s-1POSIXs0 standard by default: see the <span Class="bold">\*=posix</span> option. 
<p class="level0"><span Class="bold">QUOTING_STYLE</span> Default value of the <span Class="bold">\*=quoting-style</span> option. 
<p class="level0"><span Class="bold">SIMPLE_BACKUP_SUFFIX</span> Extension to use for simple backup file names instead of <span Class="manpage">\&.orig .</span>
<p class="level0"><span Class="bold">TMPDIR</span>, <span Class="bold">TMP</span>, <span Class="bold">TEMP</span> Directory to put temporary files in; <span Class="bold">patch</span> uses the first environment variable in this list that is set. If none are set, the default is system-dependent; it is normally <span Class="bold">/tmp</span> on Unix hosts. 
<p class="level0"><span Class="bold">VERSION_CONTROL</span> or <span Class="bold">PATCH_VERSION_CONTROL</span> Selects version control style; see the <span Class="bold">-v</span> or <span Class="bold">\*=version-control</span> option. <a name="FILES"></a><h2 class="nroffsh">FILES</h2>
<p class="level0">
<p class="level0">
<p class="level0">temporary files 
<p class="level0"><span Class="bold">/dev/tty</span> controlling terminal; used to get answers to questions asked of the user <a name="SEE"></a><h2 class="nroffsh">SEE ALSO</h2>
<p class="level0"><span Class="manpage">diff (1)</span>, <span Class="manpage">ed (1)</span>, <span Class="manpage">merge (1).</span>
<p class="level0">Marshall T. Rose and Einar A. Stefferud, Proposed Standard for Message Encapsulation, Internet <a href="http://www.ietf.org/rfc/rfc934.txt">RFC 934</a> &lt;URL:ftp://ftp.isi.edu/in-notes/rfc934.txt&gt; (1985-01). <a name="NOTES"></a><h2 class="nroffsh">NOTES FOR PATCH SENDERS</h2>
<p class="level0">There are several things you should bear in mind if you are going to be sending out patches. 
<p class="level0">Create your patch systematically. A good method is the command <span Class="bold">diff\ -Naur\  old\ new</span> where <span Class="emphasis">old</span> and <span Class="emphasis">new</span> identify the old and new directories. The names <span Class="emphasis">old</span> and <span Class="emphasis">new</span> should not contain any slashes. The <span Class="bold">diff</span> command's headers should have dates and times in Universal Time using traditional Unix format, so that patch recipients can use the <span Class="bold">-Z</span> or <span Class="bold">\*=set-utc</span> option. Here is an example command, using Bourne shell syntax: 
<p class="level0">
<p class="level1"><span Class="bold">LC_ALL=C TZ=UTC0 diff -Naur gcc-2.7 gcc-2.8</span> 
<p class="level0">
<p class="level0">Tell your recipients how to apply the patch by telling them which directory to <span Class="bold">cd</span> to, and which <span Class="bold">patch</span> options to use.  The option string <span Class="bold">-Np1</span> is recommended. Test your procedure by pretending to be a recipient and applying your patch to a copy of the original files. 
<p class="level0">You can save people a lot of grief by keeping a <span Class="bold">patchlevel.h</span> file which is patched to increment the patch level as the first diff in the patch file you send out. If you put a <span Class="bold">Prereq:\&</span> line in with the patch, it won't let them apply patches out of order without some warning. 
<p class="level0">You can create a file by sending out a diff that compares <span Class="bold">/dev/null</span> or an empty file dated the Epoch (1970-01-01 00:00:00 s-1UTCs0) to the file you want to create. This only works if the file you want to create doesn't exist already in the target directory. Conversely, you can remove a file by sending out a context diff that compares the file to be deleted with an empty file dated the Epoch. The file will be removed unless <span Class="bold">patch</span> is conforming to s-1POSIXs0 and the <span Class="bold">-E</span> or <span Class="bold">\*=remove-empty-files</span> option is not given. An easy way to generate patches that create and remove files is to use s-1GNUs0 <span Class="manpage">diff 's</span><span Class="bold">-N</span> or <span Class="bold">\*=new-file</span> option. 
<p class="level0">If the recipient is supposed to use the <span Class="bold">-p N</span> option, do not send output that looks like this: 
<p class="level0">
<p class="level1">
<p class="level1">diff -Naur v2.0.29/prog/README prog/README <br>-^-^- v2.0.29/prog/README   Mon Mar 10 15:13:12 1997 <br>+^+^+ prog/README   Mon Mar 17 14:58:22 1997 
<p class="level0">
<p class="level0">because the two file names have different numbers of slashes, and different versions of <span Class="bold">patch</span> interpret the file names differently. To avoid confusion, send output that looks like this instead: 
<p class="level0">
<p class="level1">
<p class="level1">diff -Naur v2.0.29/prog/README v2.0.30/prog/README <br>-^-^- v2.0.29/prog/README   Mon Mar 10 15:13:12 1997 <br>+^+^+ v2.0.30/prog/README   Mon Mar 17 14:58:22 1997 
<p class="level0">
<p class="level0">
<p class="level0">Avoid sending patches that compare backup file names like <span Class="manpage">README.orig</span>since this might confuse <span Class="bold">patch</span> into patching a backup file instead of the real file. Instead, send patches that compare the same base file names in different directories, e.g. <span Class="bold">old/README</span> and <span Class="manpage">new/README .</span>
<p class="level0">Take care not to send out reversed patches, since it makes people wonder whether they already applied the patch. 
<p class="level0">Try not to have your patch modify derived files (e.g. the file <span Class="bold">configure</span> where there is a line <span Class="bold">configure: configure.in</span> in your makefile), since the recipient should be able to regenerate the derived files anyway. If you must send diffs of derived files, generate the diffs using s-1UTCs0, have the recipients apply the patch with the <span Class="bold">-Z</span> or <span Class="bold">\*=set-utc</span> option, and have them remove any unpatched files that depend on patched files (e.g. with <span Class="manpage">make\ clean ).</span>
<p class="level0">While you may be able to get away with putting 582 diff listings into one file, it may be wiser to group related patches into separate files in case something goes haywire. <a name="DIAGNOSTICS"></a><h2 class="nroffsh">DIAGNOSTICS</h2>
<p class="level0">Diagnostics generally indicate that <span Class="bold">patch</span> couldn't parse your patch file. 
<p class="level0">If the <span Class="bold">\*=verbose</span> option is given, the message <span Class="bold">Hmm.\|.\|.\&</span> indicates that there is unprocessed text in the patch file and that <span Class="bold">patch</span> is attempting to intuit whether there is a patch in that text and, if so, what kind of patch it is. 
<p class="level0"><span Class="manpage">patch 's</span>exit status is 0 if all hunks are applied successfully, 1 if some hunks cannot be applied or there were merge conflicts, and 2 if there is more serious trouble. When applying a set of patches in a loop it behooves you to check this exit status so you don't apply a later patch to a partially patched file. <a name="CAVEATS"></a><h2 class="nroffsh">CAVEATS</h2>
<p class="level0">Context diffs cannot reliably represent the creation or deletion of empty files, empty directories, or special files such as symbolic links. Nor can they represent changes to file metadata like ownership, permissions, or whether one file is a hard link to another. If changes like these are also required, separate instructions (e.g. a shell script) to accomplish them should accompany the patch. 
<p class="level0"><span Class="bold">patch</span> cannot tell if the line numbers are off in an <span Class="bold">ed</span> script, and can detect bad line numbers in a normal diff only when it finds a change or deletion. A context diff using fuzz factor 3 may have the same problem. You should probably do a context diff in these cases to see if the changes made sense. Of course, compiling without errors is a pretty good indication that the patch worked, but not always. 
<p class="level0"><span Class="bold">patch</span> usually produces the correct results, even when it has to do a lot of guessing. However, the results are guaranteed to be correct only when the patch is applied to exactly the same version of the file that the patch was generated from. <a name="COMPATIBILITY"></a><h2 class="nroffsh">COMPATIBILITY ISSUES</h2>
<p class="level0">The s-1POSIXs0 standard specifies behavior that differs from <span Class="manpage">patch 's</span>traditional behavior. You should be aware of these differences if you must interoperate with <span Class="bold">patch</span> versions 2.1 and earlier, which do not conform to s-1POSIXs0. 
<p class="level0"><span Class="bold"> \(bu</span> In traditional , <span Class="manpage">patch</span>the <span Class="bold">-p</span> option's operand was optional, and a bare <span Class="bold">-p</span> was equivalent to <span Class="manpage">-p0.</span>The <span Class="bold">-p</span> option now requires an operand, and <span Class="bold">-p\ 0</span> is now equivalent to <span Class="manpage">-p0 .</span>For maximum compatibility, use options like <span Class="bold">-p0</span> and <span Class="manpage">-p1 .</span>
<p class="level0">Also, traditional <span Class="bold">patch</span> simply counted slashes when stripping path prefixes; <span Class="bold">patch</span> now counts pathname components. That is, a sequence of one or more adjacent slashes now counts as a single slash. For maximum portability, avoid sending patches containing <a class="bold" href="#">//</a> in file names. 
<p class="level0"><span Class="bold"> \(bu</span> In traditional <span Class="manpage">patch</span>backups were enabled by default. This behavior is now enabled with the <span Class="bold">-b</span> or <span Class="bold">\*=backup</span> option. 
<p class="level0">Conversely, in s-1POSIXs0 <span Class="manpage">patch</span>backups are never made, even when there is a mismatch. In s-1GNUs0 <span Class="manpage">patch</span>this behavior is enabled with the <span Class="bold">\*=no-backup-if-mismatch</span> option, or by conforming to s-1POSIXs0 with the <span Class="bold">\*=posix</span> option or by setting the <span Class="bold">POSIXLY_CORRECT</span> environment variable. 
<p class="level0">The <span Class="bold">-b \ suffix</span> option of traditional <span Class="bold">patch</span> is equivalent to the <span Class="bold">-b\ -z \ suffix</span> options of s-1GNUs0 <span Class="manpage">patch .</span>
<p class="level0"><span Class="bold"> \(bu</span> Traditional <span Class="bold">patch</span> used a complicated (and incompletely documented) method to intuit the name of the file to be patched from the patch header. This method did not conform to s-1POSIXs0, and had a few gotchas. Now <span Class="bold">patch</span> uses a different, equally complicated (but better documented) method that is optionally s-1POSIXs0-conforming; we hope it has fewer gotchas.  The two methods are compatible if the file names in the context diff header and the <span Class="bold">Index:\&</span> line are all identical after prefix-stripping. Your patch is normally compatible if each header's file names all contain the same number of slashes. 
<p class="level0"><span Class="bold"> \(bu</span> When traditional <span Class="bold">patch</span> asked the user a question, it sent the question to standard error and looked for an answer from the first file in the following list that was a terminal: standard error, standard output, <span Class="manpage">/dev/tty</span>and standard input. Now <span Class="bold">patch</span> sends questions to standard output and gets answers from <span Class="manpage">/dev/tty .</span>Defaults for some answers have been changed so that <span Class="bold">patch</span> never goes into an infinite loop when using default answers. 
<p class="level0"><span Class="bold"> \(bu</span> Traditional <span Class="bold">patch</span> exited with a status value that counted the number of bad hunks, or with status 1 if there was real trouble. Now <span Class="bold">patch</span> exits with status 1 if some hunks failed, or with 2 if there was real trouble. 
<p class="level0"><span Class="bold"> \(bu</span> Limit yourself to the following options when sending instructions meant to be executed by anyone running s-1GNUs0 <span Class="manpage">patch</span>traditional <span Class="manpage">patch</span>or a <span Class="bold">patch</span> that conforms to s-1POSIXs0. Spaces are significant in the following list, and operands are required. 
<p class="level0"><pre class="level0">
<span class="bold">-c</span> 
<span class="bold">-d  dir</span> 
<span class="bold">-D  define</span> 
<span class="bold">-e</span> 
<span class="bold">-l</span> 
<span class="bold">-n</span> 
<span class="bold">-N</span> 
<span class="bold">-o  outfile</span> 
<span class="bold">-p num</span> 
<span class="bold">-R</span> 
<span class="bold">-r  rejectfile</span> 
</pre>

<p class="level0"><a name="BUGS"></a><h2 class="nroffsh">BUGS</h2>
<p class="level0">Please report bugs via email to <span Class="manpage">&lt;bug-patch@gnu.org&gt; .</span>
<p class="level0">If code has been duplicated (for instance with <span Class="bold">&#35;ifdef OLDCODE</span> .|.|. <span Class="bold">&#35;else .|.|. &#35;endif</span>), <span Class="bold">patch</span> is incapable of patching both versions, and, if it works at all, will likely patch the wrong one, and tell you that it succeeded to boot. 
<p class="level0">If you apply a patch you've already applied, <span Class="bold">patch</span> thinks it is a reversed patch, and offers to un-apply the patch. This could be construed as a feature. 
<p class="level0">Computing how to merge a hunk is significantly harder than using the standard fuzzy algorithm.  Bigger hunks, more context, a bigger offset from the original location, and a worse match all slow the algorithm down. <a name="COPYING"></a><h2 class="nroffsh">COPYING</h2>
<p class="level0">Copyright 
<p class="level0">
<p class="level0">1984, 1985, 1986, 1988 Larry Wall. <br>Copyright 
<p class="level0">
<p class="level0">1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2009 Free Software Foundation, Inc. 
<p class="level0">Permission is granted to make and distribute verbatim copies of this manual provided the copyright notice and this permission notice are preserved on all copies. 
<p class="level0">Permission is granted to copy and distribute modified versions of this manual under the conditions for verbatim copying, provided that the entire resulting derived work is distributed under the terms of a permission notice identical to this one. 
<p class="level0">Permission is granted to copy and distribute translations of this manual into another language, under the above conditions for modified versions, except that this permission notice may be included in translations approved by the copyright holders instead of in the original English. <a name="AUTHORS"></a><h2 class="nroffsh">AUTHORS</h2>
<p class="level0">Larry Wall wrote the original version of <span Class="manpage">patch .</span>Paul Eggert removed <span Class="manpage">patch 's</span>arbitrary limits; added support for binary files, setting file times, and deleting files; and made it conform better to s-1POSIXs0. Other contributors include Wayne Davison, who added unidiff support, and David MacKenzie, who added configuration and backup support. Andreas Gr[:u]nbacher added support for merging. 