
<p class="level0"><a name="NAME"></a><h2 class="nroffsh">NAME</h2>
<p class="level0">capsh - capability shell wrapper <a name="SYNOPSIS"></a><h2 class="nroffsh">SYNOPSIS</h2>
<p class="level0"><span Class="bold">capsh</span> [<span Class="emphasis">OPTION</span>]... <a name="DESCRIPTION"></a><h2 class="nroffsh">DESCRIPTION</h2>
<p class="level0">Linux capability support and use can be explored and constrained with this tool. This tool provides a handy wrapper for certain types of capability testing and environment creation. It also provides some debugging features useful for summarizing capability state. <a name="OPTIONS"></a><h2 class="nroffsh">OPTIONS</h2>
<p class="level0">The tool takes a number of optional arguments, acting on them in the order they are provided. They are as follows: 
<p class="level0"><span Class="bold">--print</span> Display prevailing capability and related state. 
<p class="level0"><span Class="bold">--  [args]</span> Execute <span Class="bold">/bin/bash</span> with trailing arguments. Note, you can use <span Class="bold">-c 'command to execute'</span> for specific commands. 
<p class="level0"><span Class="bold">==</span> Execute <span Class="bold">capsh</span> again with remaining arguments. Useful for testing <span Class="manpage">exec ()</span>behavior. 
<p class="level0"><span Class="bold">--caps= cap-set</span> Set the prevailing process capabilities to those specified by <span Class="emphasis">cap-set .</span> Where <span Class="emphasis">cap-set</span> is a text-representation of capability state as per <span Class="manpage">cap_from_text (3).</span>
<p class="level0"><span Class="bold">--drop= cap-list</span> Remove the listed capabilities from the prevailing bounding set. The capabilities are a comma separated list of capabilities as recognized by the <span Class="manpage">cap_from_name (3)</span>function. Use of this feature requires that the capsh program is operating with <span Class="bold">CAP_SETPCAP</span> in its effective set. 
<p class="level0"><span Class="bold">--inh= cap-list</span> Set the inheritable set of capabilities for the current process to equal those provided in the comma separated list. For this action to succeed, the prevailing process should already have each of these capabilities in the union of the current inheritable and permitted capability sets, or the capsh program is operating with <span Class="bold">CAP_SETPCAP</span> in its effective set. 
<p class="level0"><span Class="bold">--user= username</span> Assume the identity of the named user. That is, look up the user's <span Class="emphasis">uid  and  gid</span> with <span Class="manpage">getpwuid (3)</span>and their group memberships with <span Class="manpage">getgrouplist (3)</span>and set them all. 
<p class="level0"><span Class="bold">--uid= id</span> Force all <span Class="bold">uid</span> values to equal <span Class="emphasis">id</span> using the <span Class="manpage">setuid (2)</span>system call. 
<p class="level0"><span Class="bold">--gid= &lt;id&gt;</span> Force all <span Class="bold">gid</span> values to equal <span Class="emphasis">id</span> using the <span Class="manpage">setgid (2)</span>system call. 
<p class="level0"><span Class="bold">--groups= &lt;id-list&gt;</span> Set the supplementary groups to the numerical list provided. The groups are set with the <span Class="manpage">setgroups (2)</span>system call. 
<p class="level0"><span Class="bold">--keep= &lt;0|1&gt;</span> In a non-pure capability mode, the kernel provides liberal privilege to the super-user. However, it is normally the case that when the super-user changes <span Class="emphasis">uid</span> to some lesser user, then capabilities are dropped. For these situations, the kernel can permit the process to retain its capabilities after a <span Class="manpage">setuid (2)</span>system call. This feature is known as <span Class="emphasis">keep-caps</span> support. The way to activate it using this script is with this argument. Setting the value to 1 will cause <span Class="emphasis">keep-caps</span> to be active. Setting it to 0 will cause keep-caps to deactivate for the current process. In all cases, <span Class="emphasis">keep-caps</span> is deactivated when an <span Class="manpage">exec ()</span>is performed. See <span Class="bold">--secbits</span> for ways to disable this feature. 
<p class="level0"><span Class="bold">--secbits= N</span> XXX - need to document this feature. 
<p class="level0"><span Class="bold">--chroot= path</span> Execute the <span Class="manpage">chroot (2)</span>system call with the new root-directory (/) equal to <span Class="emphasis">path .</span> This operation requires <span Class="bold">CAP_SYS_CHROOT</span> to be in effect. 
<p class="level0"><span Class="bold">--forkfor= sec</span> 
<p class="level0"><span Class="bold">--killit= sig</span> 
<p class="level0"><span Class="bold">--decode= N</span> This is a convenience feature. If you look at <span Class="bold">/proc/1/status</span> there are some capability related fields of the following form: 
<p class="level0">&nbsp;CapInh:	0000000000000000 &nbsp;CapPrm:	ffffffffffffffff &nbsp;CapEff:	fffffffffffffeff &nbsp;CapBnd:	ffffffffffffffff 
<p class="level0">This option provides a quick way to decode a capability vector represented in this form. For example, the missing capability from this effective set is 0x0100. By running: 
<p class="level0">&nbsp;capsh --decode=0x0100 
<p class="level0">we observe that the missing capability is: <span Class="manpage">cap_setpcap .</span>
<p class="level0"><span Class="bold">--supports= xxx</span> As the kernel evolves, more capabilities are added. This option can be used to verify the existence of a capability on the system. For example, <span Class="bold">--supports= cap_syslog</span> will cause capsh to promptly exit with a status of 1 when run on kernel 2.6.27.  However, when run on kernel 2.6.38 it will silently succeed. 
<p class="level0"><a name="EXIT"></a><h2 class="nroffsh">EXIT STATUS</h2>
<p class="level0">Following successful execution the tool exits with status 0. Following an error, the tool immediately exits with status 1. <a name="AUTHOR"></a><h2 class="nroffsh">AUTHOR</h2>
<p class="level0">Written by Andrew G. Morgan &lt;morgan@kernel.org&gt;. <a name="REPORTING"></a><h2 class="nroffsh">REPORTING BUGS</h2>
<p class="level0">Please report bugs to the author. <a name="SEE"></a><h2 class="nroffsh">SEE ALSO</h2>
<p class="level0"><span Class="manpage">libcap (3)</span>, <span Class="manpage">getcap (8)</span>, <span Class="manpage">setcap (8)</span>and <span Class="manpage">capabilities (7).</span>